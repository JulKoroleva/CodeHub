(function(m,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("codemirror/lib/codemirror.css"),require("codemirror"),require("codemirror/addon/merge/merge.css"),require("codemirror/addon/merge/merge.js"),require("diff-match-patch"),require("codemirror/addon/mode/simple.js")):typeof define=="function"&&define.amd?define(["exports","vue","codemirror/lib/codemirror.css","codemirror","codemirror/addon/merge/merge.css","codemirror/addon/merge/merge.js","diff-match-patch","codemirror/addon/mode/simple.js"],t):(m=typeof globalThis<"u"?globalThis:m||self,t(m["codemirror-editor-vue3"]={},m.Vue,null,m.codemirror,null,null,m.DiffMatchPatch))})(this,function(m,t,fe,O,ge,he,F){"use strict";!window.CodeMirror&&(window.CodeMirror=O);const _=window.CodeMirror||O,R=t.defineComponent({name:"DefaultMode",props:{name:{type:String,default:`cm-textarea-${+new Date}`},value:{type:String,default:""},content:{type:String,default:""},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>null},placeholder:{type:String,default:""}},emits:{ready:e=>e,"update:cminstance":e=>e},setup(e,{emit:o}){const a=t.ref(),n=t.ref(null),r=()=>{n.value=t.markRaw(_.fromTextArea(a.value,e.options)),o("update:cminstance",n.value);const d=t.watch(()=>e.cminstance,s=>{var y;s&&((y=e.cminstance)==null||y.setValue(e.value||e.content)),o("ready",t.unref(n)),d==null||d()},{deep:!0})};return t.onMounted(()=>{r()}),{textarea:a,initialize:r}}}),S=(e,o)=>{const a=e.__vccOpts||e;for(const[n,r]of o)a[n]=r;return a},H=["name","placeholder"];function z(e,o,a,n,r,d){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,H)}const j=S(R,[["render",z]]);window.diff_match_patch=F,window.DIFF_DELETE=-1,window.DIFF_INSERT=1,window.DIFF_EQUAL=0;const P=t.defineComponent({name:"MergeMode",props:{options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})}},emits:["update:cminstance","ready"],setup(e,{emit:o}){const a=t.ref(),n=t.ref(),r=()=>{a.value=t.markRaw(_.MergeView(n.value,e.options)),o("update:cminstance",a.value),o("ready",a)};return t.onMounted(()=>{r()}),{mergeView:n,initialize:r}}}),q={ref:"mergeView"};function U(e,o,a,n,r,d){return t.openBlock(),t.createElementBlock("div",q,null,512)}const W=S(P,[["render",U]]);var v=(e=>(e.info="info",e.warning="warning",e.error="error",e))(v||{});function L(){const e=new Date,o=e.getHours()<10?`0${e.getHours()}`:e.getHours(),a=e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes(),n=e.getSeconds()<10?`0${e.getSeconds()}`:e.getSeconds();return`${o}:${a}:${n}`}function G(e){return`#link#${JSON.stringify(e)}#link#`}function T(e){const o=/#link#(.+)#link#/g,a=[];let n;for(n=o.exec(e);n;){const r=document.createElement("a"),d=JSON.parse(n[1]),s=Object.entries(d);for(const[y,u]of s)r.setAttribute(y,u);r.className="editor_custom_link",r.innerHTML="logDownload",a.push({start:n.index,end:n.index+n[0].length,node:r}),n=o.exec(e)}return a}function J(e="",o="info"){return`#log<${o}>log#${e}#log<${o}>log#`}function I(e){const o=[];function a(){const n=/#log<(\w*)>log#((.|\r\n|\n)*?)#log<(\w*)>log#/g;let r;for(r=n.exec(e);r;){const s=r[0].replace(/\r\n/g,`
`).split(`
`),u=r[2].replace(/\r\n/g,`
`).split(`
`),h=document.createElement("span"),l=r[1];h.className=`c-editor--log__${l}`;let p=0;for(let i=0;i<s.length;i++){const f=s[i],C=u[i],w=h.cloneNode(!1);w.innerText=C,o.push({start:r.index+p,end:r.index+p+f.length,node:w}),p=p+f.length+1}r=n.exec(e)}}return a(),o}function Z(e,o){return`[${L()}] <${o}> ${e}`}function K(e,o,a){const r=new Array(Math.max(o||15,5)).join(a||"=");return`${r}${e}${r}`}const M=[{regex:/(\[.*?\])([ \t]*)(<error>[ \t])(.+)/,token:["tag","","error.strong","error.strong"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<info>)(.+)(.?)/,token:["tag","","bracket","bracket","hr"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<warning>)(.+)(.?)/,token:["tag","","comment","comment","hr"],sol:!0}];_.defineSimpleMode("fclog",{start:[...M,{regex:/.*/,token:"hr"}],error:[...M,{regex:/.*/,token:"error.strong"}],info:[...M,{regex:/.*/,token:"bracket"}],warning:[...M,{regex:/.*\[/,token:"comment"}]}),_.defineSimpleMode("log",{start:[{regex:/^[=]+[^=]*[=]+/,token:"strong"},{regex:/([^\w])([A-Z][\w]*)/,token:["","string"]},{regex:/(^[A-Z][\w]*)/,token:"string"}]});const Q=t.defineComponent({name:"CodemirrorFclog",props:{value:{type:String,default:""},name:{type:String,default:`cm-textarea-${+new Date}`},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})},placeholder:{type:String,default:""}},emits:["update:cminstance","ready"],setup(e,{emit:o}){const a=t.ref(),n=t.ref(null),r=(s=e.cminstance)=>{s.getAllMarks().forEach(l=>l.clear());const u=s.getValue(),h=[].concat(T(u)).concat(I(u));for(let l=0;l<h.length;l++){const p=h[l];s.markText(s.posFromIndex(p.start),s.posFromIndex(p.end),{replacedWith:p.node})}},d=()=>{var s;n.value=t.markRaw(_.fromTextArea(a.value,e.options)),o("update:cminstance",t.unref(n)),(s=n.value)==null||s.on("change",r)};return t.watch(()=>e.cminstance,s=>{var y;s&&(r(e.cminstance),(y=e.cminstance)==null||y.setValue(e.value),o("ready",n))},{deep:!0,immediate:!0}),t.onMounted(()=>{d()}),{initialize:d,textarea:a}}}),X=["name","placeholder"];function Y(e,o,a,n,r,d){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,X)}const ee=S(Q,[["render",Y]]),B={"update:value":()=>!0,change:(e,o)=>({value:e,cm:o}),input:()=>!0,ready:e=>e},te=["changes","scroll","beforeChange","cursorActivity","keyHandled","inputRead","electricInput","beforeSelectionChange","viewportChange","swapDoc","gutterClick","gutterContextMenu","focus","blur","refresh","optionChange","scrollCursorIntoView","update"],ne={...B,...(()=>{const e={};return te.forEach(o=>{e[o]=(...a)=>a}),e})()},x={mode:"text",theme:"default",lineNumbers:!0,smartIndent:!0,indentUnit:2};function re(e){Promise.resolve().then(()=>{const o=e.getScrollInfo();e.scrollTo(o.left,o.height)})}const oe=({props:e,cminstance:o,emit:a,internalInstance:n,content:r})=>{const d=t.computed(()=>{var u;return e.merge?(u=t.unref(o))==null?void 0:u.editor():t.unref(o)}),s=()=>{const u=[];return Object.keys(n==null?void 0:n.vnode.props).forEach(h=>{if(h.startsWith("on")){const l=h.replace(h[2],h[2].toLowerCase()).slice(2);!B[l]&&u.push(l)}}),u};return{listenerEvents:()=>{d.value.on("change",l=>{const p=l.getValue();p===r.value&&p!==""||(r.value=p,a("update:value",r.value||""),a("input",r.value||" "),Promise.resolve().then(()=>{a("change",r.value,l)}),e.keepCursorInEnd&&re(l))});const u={};s().filter(l=>!u[l]&&(u[l]=!0)).forEach(l=>{d.value.on(l,(...p)=>{a(l,...p)})})}}};function ae({props:e,cminstance:o,presetRef:a}){const n=t.ref(null),r=t.ref(null),d=t.computed(()=>{var i;return e.merge?(i=t.unref(o))==null?void 0:i.editor():t.unref(o)}),s=()=>{t.nextTick(()=>{var i;(i=d.value)==null||i.refresh()})},y=(i=e.width,f=e.height)=>{var w;n.value=String(i).replace("px",""),r.value=String(f).replace("px","");const C=r.value;(w=d.value)==null||w.setSize(n.value,C)},u=()=>{var f;const i=(f=d.value)==null?void 0:f.getWrapperElement();i==null||i.remove()},h=()=>{var f,C,w;const i=(f=d.value)==null?void 0:f.getDoc().getHistory();(C=a.value)==null||C.initialize(),u(),(w=d.value)==null||w.getDoc().setHistory(i)},l=()=>{const i=document.querySelector(".CodeMirror-gutters");return(i==null?void 0:i.style.left.replace("px",""))!=="0"};return{reload:h,refresh:s,resize:y,destroy:u,containerHeight:r,reviseStyle:()=>{if(s(),!l())return;const i=setInterval(()=>{l()?s():clearInterval(i)},60),f=setTimeout(()=>{clearInterval(i),clearTimeout(f)},400)}}}const b=t.defineComponent({__name:"index",props:{value:{type:String,default:""},options:{type:Object,default:()=>x},globalOptions:{type:Object,default:()=>x},placeholder:{type:String,default:""},border:{type:Boolean,default:!1},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},originalStyle:{type:Boolean,default:!1},keepCursorInEnd:{type:Boolean,default:!1},merge:{type:Boolean,default:!1},name:{type:String,default:""},marker:{type:Function,default:()=>null},unseenLines:{type:Array,default:()=>[]}},emits:ne,setup(e,{expose:o,emit:a}){var A,V;const n=e;typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value(c){if(c==null)throw new TypeError("Cannot convert undefined or null to object");const g=Object(c);for(let k=1;k<arguments.length;k++){const $=arguments[k];if($!=null)for(const E in $)Object.prototype.hasOwnProperty.call($,E)&&(g[E]=$[E])}return g},writable:!0,configurable:!0});const r=t.ref(null),d=t.ref(""),s=t.shallowRef(j),y=t.ref({...x,...n.globalOptions,...n.options}),u=t.getCurrentInstance(),h=n.name||((V=(A=u==null?void 0:u.parent)==null?void 0:A.type)==null?void 0:V.name)||void 0,l=t.ref(null),p=t.computed(()=>{var c;return n.merge?(c=t.unref(r))==null?void 0:c.editor():t.unref(r)}),{refresh:i,resize:f,destroy:C,containerHeight:w,reviseStyle:le}=ae({props:n,cminstance:r,presetRef:l}),{listenerEvents:de}=oe({props:n,cminstance:r,emit:a,internalInstance:u,content:d}),N=()=>{n.unseenLines!==void 0&&n.marker!==void 0&&n.unseenLines.forEach(c=>{var k,$;const g=(k=r.value)==null?void 0:k.lineInfo(c);($=r.value)==null||$.setGutterMarker(c,"breakpoints",g!=null&&g.gutterMarkers?null:n.marker())})},ue=c=>{var k,$;const g=(k=r.value)==null?void 0:k.getValue();c!==g&&(($=r.value)==null||$.setValue(c),d.value=c,le()),N()},me=()=>{de(),N(),f(n.width,n.height),a("ready",r.value),t.watch([()=>n.width,()=>n.height],([c,g])=>{f(c,g)},{deep:!0})},pe=()=>{if(n.options.mode==="fclog"||n.options.mode==="log"){s.value=ee;return}if(n.merge){s.value=W;return}s.value=j};return t.watch(()=>n.options,c=>{var g;for(const k in n.options)(g=p.value)==null||g.setOption(k,t.unref(c[k]))},{deep:!0}),t.watch(()=>n.value,c=>{ue(c)}),t.watch(()=>n.merge,pe,{immediate:!0}),t.onBeforeUnmount(()=>{C()}),o({cminstance:r,resize:f,refresh:i,destroy:C}),(c,g)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["codemirror-container",{merge:c.$props.merge,bordered:c.$props.border||c.$props.merge&&!n.originalStyle,"width-auto":!c.$props.width||c.$props.width=="100%","height-auto":!c.$props.height||c.$props.height=="100%","original-style":n.originalStyle}]),style:t.normalizeStyle({height:t.unref(w)+"px"})},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(t.unref(s)),t.mergeProps({ref_key:"presetRef",ref:l,cminstance:r.value,"onUpdate:cminstance":g[0]||(g[0]=k=>r.value=k),style:{height:"100%"}},{...c.$props,...c.$attrs,options:y.value,name:t.unref(h),content:d.value},{onReady:me}),null,16,["cminstance"]))],6))}}),ke="",D=(e,o)=>(o&&o.options&&(b.props.globalOptions.default=()=>o.options),e.component((o==null?void 0:o.componentName)||"Codemirror",b),e),se=window.CodeMirror||_,ce=D,ie=D;function styleInject(css,ref){if(ref===void 0){ref={}}var insertAt=ref.insertAt;if(!css||typeof document==="undefined"){return}var head=document.head||document.getElementsByTagName("head")[0];var style=document.createElement("style");style.type="text/css";if(insertAt==="top"){if(head.firstChild){head.insertBefore(style,head.firstChild)}else{head.appendChild(style)}}else{head.appendChild(style)}if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}};styleInject(`.codemirror-container {
  position: relative;
  display: inline-block;
  height: 100%;
  width: fit-content;
  font-size: 12px;
  overflow: hidden;
}
.codemirror-container.bordered {
  border-radius: 4px;
  border: 1px solid #dddddd;
}
.codemirror-container.width-auto {
  width: 100%;
}
.codemirror-container.height-auto {
  height: 100%;
}
.codemirror-container.height-auto .CodeMirror,
.codemirror-container.height-auto .cm-s-default {
  height: 100% !important;
}
.codemirror-container .editor_custom_link {
  cursor: pointer;
  color: #1474f1;
  text-decoration: underline;
}
.codemirror-container .editor_custom_link:hover {
  color: #04b4fa;
}
.codemirror-container:not(.original-style) .CodeMirror-lines .CodeMirror-placeholder.CodeMirror-line-like {
  color: #666;
}
.codemirror-container:not(.original-style) .CodeMirror,
.codemirror-container:not(.original-style) .CodeMirror-merge-pane {
  height: 100%;
  font-family: consolas !important;
}
.codemirror-container:not(.original-style) .CodeMirror-merge,
.codemirror-container:not(.original-style) .CodeMirror-merge-right .CodeMirror {
  height: 100%;
  border: none !important;
}
.codemirror-container:not(.original-style) .c-editor--log__error {
  color: #bb0606;
  font-weight: bold;
}
.codemirror-container:not(.original-style) .c-editor--log__info {
  color: #333333;
  font-weight: bold;
}
.codemirror-container:not(.original-style) .c-editor--log__warning {
  color: #ee9900;
}
.codemirror-container:not(.original-style) .c-editor--log__success {
  color: #669600;
}
.codemirror-container:not(.original-style) .cm-header,
.codemirror-container:not(.original-style) .cm-strong {
  font-weight: bold;
}
`),m.CodeMirror=se,m.GlobalCmComponent=ce,m.InstallCodemirro=ie,m.VueCodemirror=b,m.createLinkMark=G,m.createLog=Z,m.createLogMark=J,m.createTitle=K,m.default=b,m.getLinkMarks=T,m.getLocalTime=L,m.getLogMark=I,m.logErrorType=v,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
